<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>EnPick - 홈</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f4f6fc;
      min-height: 100vh;
      position: relative;
    }
    /* 타이틀 큰 제목 */
    .main-content h1 {
      margin-bottom: 30px;
      color: #333;
      font-size: 24px;
    }

    /* 통계 카드 */
    .stats-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-bottom: 40px;
    }

    .stat-card {
      background-color: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .stat-card h3 {
      color: #666;
      font-size: 14px;
      margin-bottom: 10px;
      font-weight: 500;
    }

    .stat-card .number {
      font-size: 28px;
      font-weight: bold;
      color: #7d87dc;
    }

    /* 오늘의 학습 섹션 */
    .learning-section {
      background-color: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .learning-section h2 {
      color: #333;
      font-size: 20px;
      margin-bottom: 20px;
    }

    @media (max-width: 1200px) {
      .stats-container {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 768px) {
      .stats-container {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- 상단 바 -->
  <nav class="nav-bar">
    <div class="nav-logo">
      <img src="assets/enpick-logo.png" alt="EnPick 로고" />
      <h2>EnPick</h2>
    </div>
    <div class="nav-user">
      <!-- 관리자 계정만 표시되는 추가 버튼 -->
      <a href="#" id="logoutBtn" class="logout-btn">로그아웃</a>
    </div>
    <div class="hamburger" id="hamburger">&#9776;</div>
  </nav>

  <!-- 사이드바 -->
  <div class="sidebar">
    <a href="home.html" class="menu-item active">홈</a>
    <a href="vocabulary.html" class="menu-item">전체 단어장</a>
    <a href="mywords.html" class="menu-item">My 단어장</a>
    <a href="study.html" class="menu-item">학습</a>
    <a href="gamestart.html" class="menu-item">단어 미니 게임</a>
    <a href="teststart.html" class="menu-item">테스트</a>
    <a href="#" class="menu-item">통계</a>
  </div>

  <!-- 메인 콘텐츠 -->
  <div class="main-content">
    <h1>학습 대시보드</h1>
    
    <!-- 통계 카드 -->
    <div class="stats-container">
      <div class="stat-card">
        <h3>오늘 학습한 단어</h3>
        <div class="number">0</div>
      </div>
      <div class="stat-card">
        <h3>누적 학습 단어</h3>
        <div class="number">0</div>
      </div>
      <div class="stat-card">
        <h3>학습 완료율</h3>
        <div class="number">0%</div>
      </div>
    </div>

    <!-- 학습 영역 -->
    <div class="learning-section">
      <h2>오늘의 학습</h2>
      <!-- 여기에 학습 콘텐츠가 들어갈 예정 -->
    </div>
  </div>

  <script>
    // 사용자 이름 표시
    document.addEventListener('DOMContentLoaded', () => {

      fetch('/api/me', { credentials: 'include' })
        .then(res => {
          if (!res.ok) throw new Error();
          return res.json();
        })
        .then(user => {
          // 예: 사용자 이메일 표시
          const userSpan = document.createElement('span');
          userSpan.textContent = `${user.email}님`;
          document.querySelector('.nav-user')?.prepend(userSpan);

          // 관리자면 버튼 보이기
          if (user.role === 'admin') {
            const adminBtn = document.createElement('a');
            adminBtn.href = 'admin.html';
            adminBtn.className = 'logout-btn';
            adminBtn.textContent = '관리자 페이지';
            document.querySelector('.nav-user')?.prepend(adminBtn);
          }
        })
        .catch(() => {
          alert('로그인이 필요합니다.');
          window.location.href = 'login.html';
        });

      // 로그아웃 버튼
      document.getElementById('logoutBtn')?.addEventListener('click', async () => {
        try {
          await fetch('/logout', {
            method: 'POST',
            credentials: 'include'
          });
        } catch (err) {
          console.error('서버 로그아웃 실패:', err);
        }

        // localStorage 정보 삭제
        localStorage.removeItem('isLoggedIn');
        localStorage.removeItem('userRole');

        // 로그인 페이지로 이동
        window.location.href = 'login.html';
      });

      // 세션에서 사용자 정보를 가져와서 표시하는 로직이 들어갈 예정
    });

    
    document.getElementById('hamburger')?.addEventListener('click', () => {
      document.querySelector('.sidebar')?.classList.toggle('show');
    });


  </script>
</body>
</html>
